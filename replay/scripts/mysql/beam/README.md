## Code to deal with beam trip and runs with multi beam currents:
* Use TSpectrum to find a list of beam on currents ( identify peaks from 1d bcm rate histogram).
* For each beam current (peak value), loop over the fast scaler output (evLeft/evRight) to find events with stable beam ( current within +-1.5uA of peak value) and accumulate charge, trigger counts. For a gas type target, by default will discard the first 5 seconds of events from stable beam after it recovered from a beam trip. This is to make sure the selected events are from target in equilibrium state.
* For each beam current, the peak current, charge, and live time (for production trigger 2 or 5) are stored in SQL database triton-work/{experiment}analysis (one row per current).
* For each beam current, the list of events from stable beam is saved as elist/bcm{runnumber}_{current_id}_{cut on how many seconds for stable beam}.root. Beam current, charge, and livetime are stored in the rootfile as TVectors, please read the last part of main code to see how to extract informations. 
* Path to the saved eventlist is saved in SQL table as well. No need to rerun the beamtrip code as long as the scaler tree info didn't change.  

### For ALL your later analysis, please load good beam events at the beginning of your scripts. See example.C.

```
analyzer [0] .L SQLanalysis.h 
analyzer [1] TChain *t = LoadList(runnum) // only work if the event list is generated by beamtrip_sql.C, and stored at somewhere you have access to
analyzer [2] GetNCurrents(1327)
          current_id             current              charge
                   0                15.1             13499.4
                   1                10.1             21749.6
analyzer [2] AnalysisInfo ana = GetAnalysisInfo(1327,1)
analyzer [3] ana.current 
(Double_t) 10.1000
analyzer [4] ana.charge 
(Double_t) 21749.6
analyzer [5] ana.livetime 
(Double_t) 0.989998

analyzer [6] AnalysisInfo ana0 = GetAnalysisInfo(1327,0)
analyzer [7] ana0.current 
(Double_t) 15.1000
analyzer [8] ana0.charge 
(Double_t) 13499.4

```
